<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Id 찾기</title>
   <!-- 부트스트랩 CSS 링크 -->
   <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet">
<script>
        // 폼이 제출될 때 실행되는 함수
        function submitForm() {
            // 폼에서 입력한 데이터를 가져와서 'formData'객체에 저장
            // "idLookupForm"인 폼 엘리먼트를 찾아오기
            var formData = new FormData(document.getElementById("idLookupForm"));
            
            //  XMLHttpRequest 객체를 생성해서 이 객체를 사용해 Ajax 요청을 통해 서버에 폼 데이터를 전송
            var xhr = new XMLHttpRequest();
            // xhr.open() 메서드는 Ajax 요청을 설정
            // POST 메서드를 사용하여 서버의 "/login/idlookup" 엔드포인트로 요청을 보내도록 설정
            xhr.open("POST", "/login/idlookup", true);
            // XMLHttpRequest 객체의 상태 변화 이벤트에 대한 핸들러를 설정
            // XMLHttpRequest의 상태가 변화할 때마다 이 함수가 호출됨
            xhr.onreadystatechange = function () {
				// 서버 응답이 도착하고 HTTP 상태 코드가 200 (성공)인 경우를 확인
                if (xhr.readyState === 4 && xhr.status === 200) {
                    // Ajax 요청이 완료되면 서버에서 반환한 결과를 알림창으로 표시
                    alert(xhr.responseText);
                }
            };
            xhr.send(formData);
        }
    </script>
    
    <!-- 부트스트랩 모달 창 열기 -->
    <script>
  // 폼 제출 이벤트 핸들러
  document.getElementById('idLookupForm').addEventListener('submit', function(event) {
    // 폼을 서버로 제출하거나 필요한 작업을 수행

    // 모달 창 열기
    $('#staticBackdrop').modal('show');

    // 이벤트 기본 동작 방지 (폼 제출 방지)
    event.preventDefault();
  });
</script>
</head>
<body>

     <div class="container">
        <h1 class="mt-5">아이디 찾기</h1>
		  <h6>이름과 이메일 주소를 입력하세요</h6>
		  <br>
		  <hr>
		  <br>
        <form action="/login/idlookup" method="post" id="idLookupForm">
        
            <!-- 이름 입력 필드 -->
            <div class="mb-3">
                <label for="userName" class="form-label">등록한 이름</label>
                <input type="text" class="form-control" id="userName" name="userName" required>
            </div>
            <!-- 이메일 입력 필드 -->
            <div class="mb-3">
                <label for="userEmail" class="form-label">등록한 이메일 주소</label>
                <input type="email" class="form-control" id="userEmail" name="userEmail" required>
            </div>
            
            <br>
            <!-- 아이디 찾기 버튼 -->
            <button type="submit" class="btn btn-primary"  data-bs-toggle="modal" data-bs-target="#staticBackdrop">아이디 찾기</button>
        </form>
    </div>

    <!-- 부트스트랩 JavaScript 및 jQuery 링크 -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.1/dist/umd/popper.min.js"></script>
    
    <!-- 모달 창에 보이게 하기(button submit으로 하면 안 되겠지) -->

    <div class="modal fade" id="staticBackdrop" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5" id="staticBackdropLabel">Modal title</h1>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
      <p>아이디 조회 결과: <span th:text="${idlookup}"></span></p>
      </div>
      <div class="modal-footer">
      <!--  
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>-->
	    <p><a href="/login">로그인 화면으로 돌아가기</a></p>
        <button type="button" class="btn btn-primary">로그인 화면으로 가기</button>
      </div>
    </div>
  </div>
</div>
</body>
</html>